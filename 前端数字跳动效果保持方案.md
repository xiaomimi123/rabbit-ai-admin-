# å‰ç«¯æ•°å­—è·³åŠ¨æ•ˆæœä¿æŒæ–¹æ¡ˆ

## ğŸ“‹ é—®é¢˜

ç”¨æˆ·è¯¢é—®ï¼šä¿®å¤åç«¯æ”¶ç›Šè®¡ç®—é—®é¢˜åï¼Œæ˜¯å¦è¿˜èƒ½å®ç°å‰ç«¯çš„æ•°å­—è·³åŠ¨å±•ç¤ºæ•ˆæœï¼Ÿ

## âœ… ç­”æ¡ˆ

**å¯ä»¥ï¼** ä¿®å¤åç«¯é—®é¢˜åï¼Œå‰ç«¯çš„æ•°å­—è·³åŠ¨æ•ˆæœ**å®Œå…¨ä¸å—å½±å“**ï¼Œå¯ä»¥ç»§ç»­æ­£å¸¸å·¥ä½œã€‚

---

## ğŸ” æ•°å­—è·³åŠ¨æ•ˆæœå®ç°åŸç†

### 1. RollingNumber ç»„ä»¶

**æ–‡ä»¶ä½ç½®**ï¼š`rabbit-ai-frontendxin/components/RollingNumber.tsx`

**å®ç°æ–¹å¼**ï¼š
- ä½¿ç”¨ `framer-motion` å®ç°æ•°å­—æ»šåŠ¨åŠ¨ç”»
- æ¯ä¸ªæ•°å­—ä½ï¼ˆ0-9ï¼‰éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ»šåŠ¨åˆ—
- å½“æ•°å€¼å˜åŒ–æ—¶ï¼Œæ•°å­—ä¼šå¹³æ»‘æ»šåŠ¨åˆ°ç›®æ ‡å€¼

**å…³é”®ä»£ç **ï¼š
```typescript
<motion.div
  animate={{ y: `-${value * 10}%` }}  // æ»šåŠ¨åˆ°ç›®æ ‡æ•°å­—ä½ç½®
  transition={{ 
    type: "spring", 
    stiffness: 120,  // å¿«é€Ÿå“åº”
    damping: 20,    
    mass: 0.8       
  }}
>
  {/* 0-9 æ•°å­—åˆ— */}
</motion.div>
```

### 2. å®æ—¶æ”¶ç›Šè®¡ç®—é€»è¾‘

**æ–‡ä»¶ä½ç½®**ï¼š`rabbit-ai-frontendxin/views/AssetView.tsx`

**è®¡ç®—æµç¨‹**ï¼š

1. **è·å–åŸºå‡†æ”¶ç›Š**ï¼ˆä» APIï¼‰ï¼š
   ```typescript
   const earningsData = await fetchEarnings(stats.address);
   const pendingUsdtValue = parseFloat(earningsData.pendingUsdt || '0');
   setEarningsBaseValue(pendingUsdtValue); // è®¾ç½®åŸºå‡†å€¼
   ```

2. **è®¡ç®—é¢„è®¡æ¯æ—¥æ”¶ç›Š**ï¼š
   ```typescript
   const estimatedDailyEarnings = ratBalance * 0.01 * (dailyRate / 100);
   ```

3. **æ¯ 5 ç§’æ›´æ–°ä¸€æ¬¡å®æ—¶æ”¶ç›Š**ï¼š
   ```typescript
   useEffect(() => {
     const updateRealTimeEarnings = () => {
       const now = Date.now();
       const timeElapsed = (now - earningsBaseTime) / (1000 * 60); // ç»è¿‡çš„åˆ†é’Ÿæ•°
       const minutesPerDay = 24 * 60;
       
       // è®¡ç®—å¢é‡æ”¶ç›Š
       const incrementalEarnings = estimatedDailyEarnings * (timeElapsed / minutesPerDay);
       
       // å®æ—¶æ”¶ç›Š = åŸºå‡†æ”¶ç›Š + å¢é‡æ”¶ç›Š + èµ é€çš„USDT
       const newRealTimeEarnings = calculatedEarningsBase + incrementalEarnings + giftedUsdt;
       
       setRealTimeEarnings(newRealTimeEarnings); // æ›´æ–°çŠ¶æ€ï¼Œè§¦å‘ RollingNumber åŠ¨ç”»
     };
     
     updateRealTimeEarnings(); // ç«‹å³æ›´æ–°ä¸€æ¬¡
     const intervalId = setInterval(updateRealTimeEarnings, 5000); // æ¯ 5 ç§’æ›´æ–°
     
     return () => clearInterval(intervalId);
   }, [earnings, estimatedDailyEarnings, earningsBaseTime, earningsBaseValue]);
   ```

4. **æ˜¾ç¤ºå®æ—¶æ”¶ç›Š**ï¼š
   ```typescript
   <RollingNumber 
     value={realTimeEarnings}  // æ¯ 5 ç§’æ›´æ–°ä¸€æ¬¡ï¼Œè§¦å‘æ»šåŠ¨åŠ¨ç”»
     decimals={6}
     prefix="$"
   />
   ```

### 3. ç¼“å­˜æœºåˆ¶ï¼ˆæ™ºèƒ½é”šå®šæ—¶é—´æˆ³ï¼‰

**ç›®çš„**ï¼šç¡®ä¿åˆ·æ–°é¡µé¢åï¼Œæ•°å­—è·³åŠ¨æ•ˆæœè¿ç»­ï¼Œä¸ä¼šé‡ç½®

**å®ç°é€»è¾‘**ï¼š
```typescript
// è¯»å–ç¼“å­˜
const stored = localStorage.getItem(STORE_KEY);
if (stored) {
  const { baseValue, timestamp } = JSON.parse(stored);
  
  // å¦‚æœ API è¿”å›çš„å€¼å’Œç¼“å­˜ä¸€è‡´ï¼Œæ²¿ç”¨æ—§æ—¶é—´æˆ³
  if (Math.abs(pendingUsdtValue - baseValue) < 0.0001) {
    anchorTime = timestamp; // ä¿æŒæ—§æ—¶é—´ï¼Œè®©æ”¶ç›Šæ›²çº¿è¿ç»­ï¼
  } else {
    // å¦‚æœé‡‘é¢å˜äº†ï¼ˆåå°ç»“ç®—äº†ï¼‰ï¼Œé‡ç½®æ—¶é—´æˆ³
    anchorTime = Date.now();
  }
}
```

---

## âœ… ä¿®å¤åçš„å½±å“åˆ†æ

### ä¿®å¤å‰çš„é—®é¢˜

1. **åç«¯é—®é¢˜**ï¼š
   - `completeWithdrawal` é‡å¤æ‰£é™¤ `usdt_total`
   - å¯¼è‡´ `usdt_total` ä¸æ­£ç¡®
   - API è¿”å›çš„ `pendingUsdt` è®¡ç®—é”™è¯¯

2. **å‰ç«¯æ˜¾ç¤º**ï¼š
   - è™½ç„¶æ•°å­—è·³åŠ¨æ•ˆæœæ­£å¸¸ï¼Œä½†æ˜¾ç¤ºçš„æ•°å€¼ä¸æ­£ç¡®
   - ä¾‹å¦‚ï¼šæ˜¾ç¤º 2.2 USDTï¼Œä½†å®é™…åº”è¯¥æ˜¯ 8 USDT

### ä¿®å¤åçš„æ•ˆæœ

1. **åç«¯ä¿®å¤**ï¼š
   - `completeWithdrawal` ä¸å†é‡å¤æ‰£é™¤ `usdt_total`
   - `usdt_total` æ­£ç¡®æ›´æ–°
   - API è¿”å›çš„ `pendingUsdt` è®¡ç®—æ­£ç¡®

2. **å‰ç«¯æ˜¾ç¤º**ï¼š
   - âœ… æ•°å­—è·³åŠ¨æ•ˆæœ**å®Œå…¨ä¸å—å½±å“**
   - âœ… æ˜¾ç¤ºçš„æ•°å€¼**æ›´åŠ å‡†ç¡®**
   - âœ… ç”¨æˆ·ä½“éªŒ**æ›´å¥½**

### ä¸ºä»€ä¹ˆæ•°å­—è·³åŠ¨æ•ˆæœä¸å—å½±å“ï¼Ÿ

**åŸå› **ï¼š
- æ•°å­—è·³åŠ¨æ•ˆæœä¾èµ–äºï¼š
  1. âœ… **API è¿”å›çš„ `pendingUsdt`**ï¼ˆä½œä¸ºåŸºå‡†å€¼ï¼‰- ä¿®å¤åæ›´å‡†ç¡®
  2. âœ… **é¢„è®¡æ¯æ—¥æ”¶ç›Š**ï¼ˆä»ä½™é¢å’Œæ—¥åˆ©ç‡è®¡ç®—ï¼‰- ä¸å—å½±å“
  3. âœ… **æ—¶é—´å·®**ï¼ˆä» `anchorTime` åˆ°ç°åœ¨ï¼‰- ä¸å—å½±å“
  4. âœ… **æ¯ 5 ç§’æ›´æ–°æœºåˆ¶** - ä¸å—å½±å“

- ä¿®å¤åªæ˜¯è®© API è¿”å›çš„ `pendingUsdt` **æ›´å‡†ç¡®**ï¼Œä¸å½±å“å‰ç«¯çš„è®¡ç®—å’Œæ˜¾ç¤ºé€»è¾‘

---

## ğŸ“Š æ•°å­—è·³åŠ¨æ•ˆæœç¤ºä¾‹

### æ•ˆæœå±•ç¤º

**åˆå§‹çŠ¶æ€**ï¼š
- API è¿”å›ï¼š`pendingUsdt = 2.202551`
- æ˜¾ç¤ºï¼š`$2.202551`ï¼ˆRollingNumber ç»„ä»¶ï¼‰

**5 ç§’å**ï¼š
- å¢é‡æ”¶ç›Šï¼š`0.000150 USDT`ï¼ˆå‡è®¾æ¯æ—¥æ”¶ç›Š 2.6 USDTï¼‰
- æ˜¾ç¤ºï¼š`$2.202701`ï¼ˆæ•°å­—å¹³æ»‘æ»šåŠ¨ï¼‰

**10 ç§’å**ï¼š
- å¢é‡æ”¶ç›Šï¼š`0.000300 USDT`
- æ˜¾ç¤ºï¼š`$2.202851`ï¼ˆæ•°å­—ç»§ç»­æ»šåŠ¨ï¼‰

**1 å°æ—¶å**ï¼š
- å¢é‡æ”¶ç›Šï¼š`0.108333 USDT`
- æ˜¾ç¤ºï¼š`$2.310884`ï¼ˆæ•°å­—æŒç»­æ»šåŠ¨ï¼‰

**24 å°æ—¶å**ï¼š
- å¢é‡æ”¶ç›Šï¼š`2.6 USDT`ï¼ˆè¾¾åˆ°æ¯æ—¥æ”¶ç›Šä¸Šé™ï¼‰
- æ˜¾ç¤ºï¼š`$4.802551`ï¼ˆæ•°å­—åœæ­¢å¢é•¿ï¼Œç­‰å¾…ä¸‹æ¬¡ API æ›´æ–°ï¼‰

### åŠ¨ç”»ç‰¹ç‚¹

1. **å¹³æ»‘æ»šåŠ¨**ï¼š
   - æ¯ä¸ªæ•°å­—ä½ç‹¬ç«‹æ»šåŠ¨
   - ä½¿ç”¨ spring åŠ¨ç”»ï¼Œæœ‰å¼¹æ€§æ•ˆæœ
   - è§†è§‰ä¸Šéå¸¸æµç•…

2. **å®æ—¶æ›´æ–°**ï¼š
   - æ¯ 5 ç§’æ›´æ–°ä¸€æ¬¡
   - æ•°å­—æŒç»­å¢é•¿
   - ç»™ç”¨æˆ·"æ”¶ç›Šåœ¨å®æ—¶å¢é•¿"çš„æ„Ÿè§‰

3. **è¿ç»­æ€§å¥½**ï¼š
   - åˆ·æ–°é¡µé¢åï¼Œä½¿ç”¨ç¼“å­˜çš„æ—¶é—´æˆ³
   - æ•°å­—ä»åˆ·æ–°å‰çš„å€¼å¹³æ»‘è¿‡æ¸¡
   - ä¸ä¼šå‡ºç°è·³è·ƒ

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### 1. æ›´æ–°é¢‘ç‡

**å½“å‰è®¾ç½®**ï¼šæ¯ 5 ç§’æ›´æ–°ä¸€æ¬¡

**è®¡ç®—ä¾æ®**ï¼š
- å‡è®¾æ¯æ—¥æ”¶ç›Š 2.6 USDTï¼Œ24 å°æ—¶ = 86400 ç§’
- æ¯ 5 ç§’æ›´æ–°ï¼šå¢é‡ = `2.6 * 5 / 86400 â‰ˆ 0.000150 USDT`
- è¿™æ ·æœ€åä¸€ä½å°æ•°ï¼ˆ0.000001ï¼‰ä¼šæ˜æ˜¾å˜åŒ–
- æ—¢å¹³æ»‘åˆä¸ä¼šå¤ªå¿«

### 2. ç²¾åº¦æ§åˆ¶

**æ˜¾ç¤ºç²¾åº¦**ï¼š6 ä½å°æ•°

**åŸå› **ï¼š
- æ”¯æŒç§’çº§ç²¾åº¦
- è®©æ•°å­—è·³åŠ¨æ›´æ˜æ˜¾
- ç”¨æˆ·ä½“éªŒæ›´å¥½

### 3. ä¸Šé™æ§åˆ¶

**æ¯æ—¥æ”¶ç›Šä¸Šé™**ï¼š
```typescript
const maxDailyEarnings = calculatedEarningsBase + estimatedDaily + giftedUsdt;
const cappedEarnings = Math.min(newRealTimeEarnings, maxDailyEarnings);
```

**ä½œç”¨**ï¼š
- é˜²æ­¢æ•°å­—æ— é™å¢é•¿
- ç¡®ä¿ä¸è¶…è¿‡æ¯æ—¥æ”¶ç›Šä¸Šé™
- ç­‰å¾…ä¸‹æ¬¡ API æ›´æ–°åé‡ç½®

---

## âœ… ç»“è®º

### ä¿®å¤åçš„ä¼˜åŠ¿

1. **æ•°å­—è·³åŠ¨æ•ˆæœä¿æŒ**ï¼š
   - âœ… å®Œå…¨ä¸å—å½±å“
   - âœ… ç»§ç»­æ­£å¸¸å·¥ä½œ
   - âœ… ç”¨æˆ·ä½“éªŒä¸å˜

2. **æ•°å€¼å‡†ç¡®æ€§æå‡**ï¼š
   - âœ… API è¿”å›çš„å€¼æ›´å‡†ç¡®
   - âœ… æ˜¾ç¤ºçš„æ•°å€¼æ›´æ­£ç¡®
   - âœ… ç”¨æˆ·ä¿¡ä»»åº¦æå‡

3. **åŠŸèƒ½å®Œæ•´æ€§**ï¼š
   - âœ… æ‰€æœ‰åŠŸèƒ½æ­£å¸¸
   - âœ… æ²¡æœ‰å‰¯ä½œç”¨
   - âœ… å‘åå…¼å®¹

### å»ºè®®

1. **ä¿æŒç°æœ‰å®ç°**ï¼š
   - ä¸éœ€è¦ä¿®æ”¹å‰ç«¯ä»£ç 
   - æ•°å­—è·³åŠ¨æ•ˆæœä¼šè‡ªåŠ¨ä½¿ç”¨æ­£ç¡®çš„ API å€¼
   - ç”¨æˆ·ä½“éªŒä¼šæ›´å¥½

2. **ç›‘æ§å’Œæµ‹è¯•**ï¼š
   - æµ‹è¯•æ•°å­—è·³åŠ¨æ•ˆæœæ˜¯å¦æ­£å¸¸
   - éªŒè¯æ˜¾ç¤ºçš„æ•°å€¼æ˜¯å¦å‡†ç¡®
   - ç¡®ä¿ç¼“å­˜æœºåˆ¶æ­£å¸¸å·¥ä½œ

3. **ä¼˜åŒ–å»ºè®®**ï¼ˆå¯é€‰ï¼‰ï¼š
   - å¯ä»¥è€ƒè™‘è°ƒæ•´æ›´æ–°é¢‘ç‡ï¼ˆå½“å‰ 5 ç§’ï¼‰
   - å¯ä»¥ä¼˜åŒ–åŠ¨ç”»å‚æ•°ï¼ˆå½“å‰ stiffness: 120ï¼‰
   - å¯ä»¥æ·»åŠ æ›´å¤šè§†è§‰æ•ˆæœ

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**ï¼š2026-01-05  
**ç»“è®º**ï¼šâœ… ä¿®å¤åç«¯é—®é¢˜åï¼Œå‰ç«¯æ•°å­—è·³åŠ¨æ•ˆæœ**å®Œå…¨ä¸å—å½±å“**ï¼Œå¯ä»¥ç»§ç»­æ­£å¸¸å·¥ä½œ  
**å»ºè®®**ï¼šä¿æŒç°æœ‰å®ç°ï¼Œæ— éœ€ä¿®æ”¹å‰ç«¯ä»£ç 

